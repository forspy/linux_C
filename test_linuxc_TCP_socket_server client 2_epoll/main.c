/******************************************************************************

                  版权所有 (C), 2017-2017, 

 ******************************************************************************
  文 件 名   : main.c
  版 本 号   : 初稿
  作    者   : 
  生成日期   : 2017年7月11日
  最近修改   :
  功能描述   : 主函数
  函数列表   :
*
*       1.                main
*
  修改历史   :
  1.日    期   : 2017年7月11日
    作    者   : 
    修改内容   : 创建文件

******************************************************************************/

/*----------------------------------------------*
 * 外部变量说明                                 *
 *----------------------------------------------*/

/*----------------------------------------------*
 * 外部函数原型说明                             *
 *----------------------------------------------*/

/*----------------------------------------------*
 * 内部函数原型说明                             *
 *----------------------------------------------*/

/*----------------------------------------------*
 * 全局变量                                     *
 *----------------------------------------------*/

/*----------------------------------------------*
 * 模块级变量                                   *
 *----------------------------------------------*/

/*----------------------------------------------*
 * 常量定义                                     *
 *----------------------------------------------*/

/*----------------------------------------------*
 * 宏定义                                       *
 *----------------------------------------------*/

#include "server.h"


/*****************************************************************************
 函 数 名  : main
 功能描述  : 主函数
 输入参数  : int argc
             char *argv[]
 输出参数  : 无
 返 回 值  : int
 调用函数  : 
 被调函数  : 
 
 修改历史      :
  1.日    期   : 2017年7月9日
    作    者   : 
    修改内容   : 新生成函数

*****************************************************************************/
int main( int argc, char *argv[] )
{
	int iSrvfd;
	int iRet=0;
	//创建并初始化服务器对象
	if((iRet=SRV_init())<0)
	{
		goto err;
	}
	//服务流程初始化创建socket 绑定blind 监听 listen
	iSrvfd=SRV_creat_proc_server(IPADDR,PORT);//返回一个socket()函数的句柄
    if(iSrvfd<0)
    {
		printf("SRV_creat_proc_server error\n");
		iRet = iSrvfd;
		goto err1;
	}
	//处理客户端请求
	SRV_handle_client(iSrvfd);
	SRV_release();
	return 0;
err1:
	SRV_release();
err:
	return iRet
}
